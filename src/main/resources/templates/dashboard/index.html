<!DOCTYPE html>
<html lang="az" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{dashboard/layout}">
<th:block layout:fragment="page-header">
    <h1 class="mb-4">İdarə Paneli (Dashboard)</h1>
</th:block>

<div layout:fragment="content">

    <div class="row mb-5">

        <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow border-start border-5" style="border-color: #198754!important;">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col me-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">BU GÜN GƏLİR</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                 th:text="${#numbers.formatDecimal(todayRevenue, 1, 'COMMA', 2, 'POINT') + ' AZN'}">1,250.75 AZN</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-currency-dollar fa-2x text-success"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow border-start border-5" style="border-color: #0d6efd!important;">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col me-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">BU GÜN SİFARİŞ SAYI</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${todayOrdersCount}">45</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-receipt fa-2x text-primary"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow border-start border-5" style="border-color: #555!important;">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col me-2">
                            <div class="text-xs font-weight-bold text-secondary text-uppercase mb-1">ÜMUMİ İSTİFADƏÇİ SAYI</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                 th:text="${totalUsers}">1500</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-people fa-2x text-secondary"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow border-start border-5" style="border-color: #ff6600!important;">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col me-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">AKTİV MƏHSULLAR</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${activeProductCount}">120</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-handbag fa-2x" style="color: #ff6600;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow border-start border-5" style="border-color: #dc3545!important;">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col me-2">
                            <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">ƏN ÇOX SATILAN (HƏFTƏ)</div>
                            <div class="h6 mb-0 text-gray-800" th:text="${topSellingProduct}">Cheeseburger Menu</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-star fa-2x text-danger"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3 bg-light">
            <h6 class="m-0 font-weight-bold text-dark">Son 5 Sifariş</h6>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0">
                    <thead class="bg-light">
                    <tr>
                        <th>ID</th>
                        <th>Müştəri</th>
                        <th>Tarix</th>
                        <th>Ümumi Məbləğ</th>
                        <th>Status</th>
                        <th>Əməliyyat</th>
                    </tr>
                    </thead>
                    <tbody>

                    <tr th:if="${#lists.isEmpty(recentOrders)}">
                        <td colspan="6" class="text-center text-muted py-4">
                            Hal-hazırda sistemdə heç bir sifariş yoxdur.
                        </td>
                    </tr>

                    <tr th:each="order : ${recentOrders}">
                        <td th:text="${order.id}">105</td>
                        <td th:text="${order.fullName}">Fatma Xəlilova</td>
                        <td th:text="${#temporals.format(order.orderDate, 'dd MMM yyyy HH:mm')}">29 Oct 2025 14:45</td>
                        <td th:text="${#numbers.formatDecimal(order.totalPrice, 1, 'COMMA', 2, 'POINT') + ' AZN'}">32.00 AZN</td>

                        <td>
                            <span class="badge text-white p-2"
                                  th:classappend="${order.orderStatus == 'TAMAMLANDI' ? 'bg-success' :
                                                    (order.orderStatus == 'LƏĞV EDİLDİ' ? 'bg-danger' :
                                                    (order.orderStatus == 'HAZIRLANIR' ? 'bg-warning' :
                                                    'bg-info'))}"
                                  th:text="${order.orderStatus}">YENİ</span>
                        </td>

                        <td><a th:href="@{/admin/orders/edit-status/{id}(id=${order.id})}" class="btn btn-sm btn-info text-white"><i class="bi bi-eye"></i> Bax</a></td>
                    </tr>

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</html>