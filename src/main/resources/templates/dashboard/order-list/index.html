<!DOCTYPE html>
<html lang="az"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{dashboard/layout}">
<head>
    <title layout:title-pattern="$CONTENT_TITLE | FF Admin">Sifarişlər</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" layout:fragment="page-css-link">

    <style layout:fragment="page-css">
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        /* Vurğu rəngləri sidebar və Məhsullar səhifəsi ilə uyğunlaşdırılır (Narıncı) */
        :root {
            --ff-primary-color: #ff6600; /* Narıncı */
            --ff-dark-color: #212529; /* Tünd (Sidebar) */
            --ff-light-bg: #f7f9fc; /* Açıq fon */
            --ff-text-color: #1a202c;
        }

        /* ======== Reset & Base ======== */
        body {
            background: var(--ff-light-bg);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--ff-text-color);
        }

        /* Yalnız bu səhifənin kontent boşluğunu təmin edirik */
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .page-header-fragment {
            padding: 2rem 2rem 1rem;
        }

        .header-content h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .header-content h1 i {
            color: var(--ff-primary-color);
            margin-right: 10px;
        }

        .header-subtitle {
            color: #718096;
            font-size: 0.95rem;
        }

        /* ======== Stats Cards ======== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: #ffffff;
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .stat-icon.primary { background: var(--ff-primary-color); color: white; }
        .stat-icon.success { background: #10b981; color: white; }
        .stat-icon.warning { background: #f5576c; color: white; }
        .stat-icon.info { background: #4facfe; color: white; }

        .stat-label {
            font-size: 0.75rem; color: #718096; text-transform: uppercase; font-weight: 600;
        }
        .stat-value {
            font-size: 1.5rem; font-weight: 700; color: var(--ff-text-color);
        }

        /* ======== Main Table Container (Card stili) ======== */
        .order-table-container {
            background: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
            border: 1px solid #e3e6f0;
        }

        .table-header {
            padding: 0.75rem 1.25rem;
            background: #f8f9fc;
            border-bottom: 1px solid #e3e6f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .table-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--ff-dark-color);
        }

        /* Axtarış Qutusu */
        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box input {
            width: 100%; padding: 0.5rem 1rem 0.5rem 2.5rem; border: 1px solid #ced4da;
            border-radius: 0.35rem; font-size: 0.9rem;
        }

        .search-box input:focus {
            outline: 0; border-color: var(--ff-primary-color);
            box-shadow: 0 0 0 0.25rem rgba(255, 102, 0, 0.25);
        }

        .search-box i {
            position: absolute; left: 0.8rem; top: 50%; transform: translateY(-50%); color: #6c757d;
        }

        /* ======== Table Styles ======== */
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: separate; border-spacing: 0; }
        thead { background: #eaecf4; }
        th {
            text-transform: uppercase; font-size: 0.75rem; color: #4a5568;
            padding: 0.75rem 1.25rem; font-weight: 600; border-bottom: 1px solid #e3e6f0;
        }

        td { padding: 0.75rem 1.25rem; border-bottom: 1px solid #f1f1f1; font-size: 0.9rem; vertical-align: middle; }
        tbody tr:hover { background: #f9f9f9; }

        /* ======== Order ID Badge (Narıncı) ======== */
        .order-id {
            font-weight: 600; color: #fff; background: var(--ff-primary-color);
            padding: 0.3rem 0.6rem; border-radius: 0.25rem; font-size: 0.8rem;
            display: inline-flex; align-items: center; gap: 0.4rem;
        }
        .order-id i { font-size: 0.7rem; }

        /* ================================================= */
        /* ======== Müştəri Məlumatı Düzəlişi (Təmiz) ======== */
        /* ================================================= */

        .customer-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .customer-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--ff-primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .customer-details {
            display: flex;
            flex-direction: column;
        }

        .customer-name {
            font-weight: 600;
            color: #2d3748; /* Təmiz tünd mətn */
            margin-bottom: 0.1rem;
            background: none !important; /* Əlavə təminat üçün */
            padding: 0 !important;
        }

        .customer-contact {
            font-size: 0.75rem;
            color: #718096; /* Telefon nömrəsi açıq boz */
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .customer-contact span {
            background: none !important; /* Əlavə təminat üçün */
            padding: 0 !important;
            color: #718096;
        }

        /* ======== Address Styling ======== */
        .address-cell {
            max-width: 200px;
            color: #4a5568;
            font-size: 0.85rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* ======== Price Styling ======== */
        .price-cell {
            font-weight: 700;
            color: #10b981; /* Yaşıl */
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        /* ======== Status Badges (Qalır) ======== */
        .status {
            font-weight: 600; padding: 0.4rem 0.8rem; border-radius: 0.25rem;
            font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .status.NEW { background: #bfdbfe; color: #1d4ed8; }
        .status.PREPARING { background: #fde68a; color: #d97706; }
        .status.SHIPPED { background: #dbeafe; color: #1d4ed8; }
        .status.DELIVERED { background: #bbf7d0; color: #15803d; }
        .status.CANCELLED { background: #fecaca; color: #b91c1c; }


        /* ======== Action Buttons (Məhsullar səhifəsi ilə eyni) ======== */
        .actions-cell { display: flex; gap: 0.5rem; justify-content: center; }

        .action-btn {
            width: 32px; height: 32px; border-radius: 0.25rem; border: none;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 0.8rem; box-shadow: 0 0.05rem 0.2rem rgba(0, 0, 0, 0.1);
        }

        .action-btn.view { background: #ffc107; color: #212529; } /* Sarı/Warning */
        .action-btn.view i { font-size: 0.9rem; }
        .action-btn.view:hover { background: #e0a800; transform: translateY(-1px); }

        .action-btn.edit { background: #dc3545; color: white; } /* Qırmızı/Danger */
        .action-btn.edit i { font-size: 0.9rem; }
        .action-btn.edit:hover { background: #c82333; transform: translateY(-1px); }

        /* ======== Empty State ======== */
        .empty-table { text-align: center; padding: 3rem 2rem; }
        .empty-icon { width: 100px; height: 100px; margin: 0 auto 1rem; background: var(--ff-primary-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; opacity: 0.1; }
        .empty-icon i { color: var(--ff-primary-color); font-size: 3rem; opacity: 1; }
        .empty-title { font-size: 1.25rem; font-weight: 700; color: #2d3748; margin-bottom: 0.5rem; }
        .empty-subtitle { font-size: 0.9rem; color: #718096; }

        /* Responsive stillər sadələşdirilir */
        @media (max-width: 768px) {
            .dashboard-container { padding: 0 1rem; }
            .stats-grid { grid-template-columns: 1fr; }
            .table-header { flex-direction: column; gap: 0.5rem; align-items: flex-start; }
            .search-box { width: 100%; }
        }
    </style>
</head>

<th:block layout:fragment="page-header">
    <div class="page-header-fragment">
        <div class="header-content">
            <h1>
                <i class="fas fa-receipt"></i>
                Sifarişlər İdarəsi
            </h1>
            <p class="header-subtitle">Bütün sifarişlərinizi buradan idarə edə bilərsiniz</p>
        </div>
    </div>
</th:block>

<div layout:fragment="content">
    <div class="dashboard-container">

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon primary">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-label">Toplam Sifariş</div>
                    <div class="stat-value" th:text="${#lists.size(orders)}">0</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon success">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-label">Çatdırılıb</div>
                    <div class="stat-value">0</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon warning">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-label">Gözləmədə</div>
                    <div class="stat-value">0</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon info">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-label">Toplam Gəlir</div>
                    <div class="stat-value">0 ₼</div>
                </div>
            </div>
        </div>

        <div class="order-table-container">
            <div class="table-header">
                <div class="table-title">
                    <i class="fas fa-list"></i>
                    Son Sifarişlər
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Sifariş axtar...">
                </div>
            </div>

            <div class="table-wrapper">
                <table>
                    <thead>
                    <tr>
                        <th>Sifariş ID</th>
                        <th>Tarix</th>
                        <th>Müştəri</th>
                        <th>Ünvan</th>
                        <th style="text-align: right;">Məbləğ</th>
                        <th>Status</th>
                        <th style="text-align: center;">Əməliyyatlar</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="order : ${orders}">
                        <td>
                            <span class="order-id">
                                <i class="fas fa-hashtag"></i>
                                <span th:text="${order.id}"></span>
                            </span>
                        </td>
                        <td>
                            <div class="date-cell">
                                <span class="date-main" th:text="${#temporals.format(order.orderDate, 'dd.MM.yyyy')}"></span>
                                <span class="date-time">
                                    <i class="far fa-clock"></i>
                                    <span th:text="${#temporals.format(order.orderDate, 'HH:mm')}"></span>
                                </span>
                            </div>
                        </td>
                        <td>
                            <div class="customer-info">
                                <div class="customer-avatar" th:text="${#strings.substring(order.fullName, 0, 1)}"></div>
                                <div class="customer-details">
                                    <div class="customer-name" th:text="${order.fullName}"></div>
                                    <div class="customer-contact">
                                        <i class="fas fa-phone"></i>
                                        <span th:text="${order.phoneNumber}"></span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="address-cell" th:text="${order.address}"></div>
                        </td>
                        <td style="text-align: right;">
                            <div class="price-cell">
                                <i class="fas fa-coins"></i>
                                <span th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'COMMA', 2, 'POINT')} + ' ₼'"></span>
                            </div>
                        </td>
                        <td>
                            <span th:class="|status ${order.orderStatus}|" th:text="${order.orderStatus}"></span>
                        </td>
                        <td>
                            <div class="actions-cell">
                                <a th:href="@{/admin/orders/details/{id}(id=${order.id})}" class="action-btn view" title="Bax">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <a th:href="@{/admin/orders/edit-status/{id}(id=${order.id})}" class="action-btn edit" title="Düzəlt">
                                    <i class="fas fa-edit"></i>
                                </a>
                            </div>
                        </td>
                    </tr>

                    <tr th:if="${#lists.isEmpty(orders)}">
                        <td colspan="7" class="empty-table">
                            <div class="empty-icon">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <div class="empty-title">Heç bir sifariş tapılmadı</div>
                            <div class="empty-subtitle">Hal-hazırda heç bir sifariş yoxdur.</div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</html>